#!/bin/sh

if [ -z ${NGROK_AUTHTOKEN} ]; then
  echo "â›”ï¸  Please provide \$NGROK_AUTHTOKEN. You can find it at https://dashboard.ngrok.com/auth"
  stop
fi

echo "ðŸš€  Starting dvsync server..."

echo -e "\nðŸ”‘  Generating server RSA key..."
ssh-keygen -f ~/.ssh/id_rsa -N '' -q

echo -e "\nðŸ”‘  Generating client RSA key..."
ssh-keygen -f ~/.ssh/client_rsa -N '' -q
cp ~/.ssh/client_rsa.pub ~/.ssh/authorized_keys

echo -e "\nðŸ”  Setting ngrok auth token..."
ngrok authtoken ${NGROK_AUTHTOKEN} > /dev/null
